<!DOCTYPE html>
<html>
<head>
    <title>Verify Email</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='res/core.css') }}">
</head>
<body class="login-page">
    <div class="card">
        <h2>Enter Verification Code</h2>
        <p>A code was sent to your organization email.</p>
        <div id="countdown" style="font-size: 1.2em; font-weight: bold; color: #d9534f; margin-bottom: 10px; text-align: center;">
            Time remaining: <span id="timer">05:00</span>
        </div>
        {% if error %}<div class="error" style="color: #ff4444; margin-bottom: 10px;">{{ error }}</div>{% endif %}
        <form method="POST">
            <input type="text" name="otp" placeholder="6-digit code" required style="text-align: center; letter-spacing: 5px;">
            <button type="submit">Verify & Register</button>
        </form>
        <hr>
        <div style="text-align: center;">
            <p style="font-size: 0.8em; color: #666;">Didn't get the code?</p>
            <form action="/resend_otp" method="POST">
                <button type="submit" id="resendBtn" style="background: #666; font-size: 12px; padding: 5px 10px;">Resend Code</button>
            </form>
        </div>
    </div>
    <script>
        let timeLeft = {{ remaining }};
        const display = document.querySelector('#timer');
        function startTimer() {
            const timer = setInterval(function () {
                let minutes = Math.floor(timeLeft / 60);
                let seconds = timeLeft % 60;
                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;
                display.textContent = minutes + ":" + seconds;
                if (--timeLeft < 0) {
                    clearInterval(timer);
                    display.textContent = "EXPIRED";
                    display.style.color = "#888";
                }
            }, 1000);
        }
        if (timeLeft > 0) startTimer();
        else display.textContent = "EXPIRED";
    </script>
</body>
</html>